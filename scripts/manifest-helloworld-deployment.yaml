apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: helloworld-[stage]
spec:
  replicas: [replicas]
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 1
    type: RollingUpdate
  template:
    metadata:
      labels:
        app: helloworld
        stage: [stage]
    spec:
      containers:
      - name: helloworld
        image: quay.io/aleks_saul/hello_world:[tag]
        env:
        - name: HELLOWORLD_displayexternalip
          valueFrom:
            configMapKeyRef:
              name: helloworld-config
              key: displayexternalip
        - name: HELLOWORLD_displaygeolocation
          valueFrom:
            configMapKeyRef:
              name: helloworld-config
              key: displaygeolocation
        resources:
          requests:
            cpu: 400m
        livenessProbe:
          httpGet:
            # Path to probe; should be cheap, but representative of typical behavior
            path: /index.html
            port: 80
          initialDelaySeconds: 30
          timeoutSeconds: 1
